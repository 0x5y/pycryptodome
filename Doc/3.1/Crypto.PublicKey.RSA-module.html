<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Crypto.PublicKey.RSA</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="Crypto-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.pycryptodome.org/">PyCryptodome.org</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="Crypto-module.html">Package&nbsp;Crypto</a> ::
        <a href="Crypto.PublicKey-module.html">Package&nbsp;PublicKey</a> ::
        Module&nbsp;RSA
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module RSA</h1><p class="nomargin-top"></p>
<p>RSA public-key cryptography algorithm (signature and encryption).</p>
<p><a class="rst-reference external" href="http://en.wikipedia.org/wiki/RSA_%28algorithm%29" target="_top">RSA</a> is the most widespread and used public key algorithm. Its security is
based on the difficulty of factoring large integers. The algorithm has
withstood attacks for 30 years, and it is therefore considered reasonably
secure for new designs.</p>
<p>The algorithm can be used for both confidentiality (encryption) and
authentication (digital signature). It is worth noting that signing and
decryption are significantly slower than verification and encryption.
The cryptograhic strength is primarily linked to the length of the modulus <em>n</em>.
In 2012, a sufficient length is deemed to be 2048 bits. For more information,
see the most recent <a class="rst-reference external" href="http://www.ecrypt.eu.org/documents/D.SPA.17.pdf" target="_top">ECRYPT</a> report.</p>
<p>Both RSA ciphertext and RSA signature are as big as the modulus <em>n</em> (256
bytes if <em>n</em> is 2048 bit long).</p>
<p>This module provides facilities for generating fresh, new RSA keys, constructing
them from known components, exporting them, and importing them.</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">from</span> Crypto.PublicKey <span class="py-keyword">import</span> RSA
<span class="py-prompt">&gt;&gt;&gt;</span>
<span class="py-prompt">&gt;&gt;&gt; </span>key = RSA.generate(2048)
<span class="py-prompt">&gt;&gt;&gt; </span>f = open(<span class="py-string">'mykey.pem'</span>,<span class="py-string">'w'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>f.write(key.exportKey(<span class="py-string">'PEM'</span>))
<span class="py-prompt">&gt;&gt;&gt; </span>f.close()
<span class="py-more">...</span>
<span class="py-prompt">&gt;&gt;&gt; </span>f = open(<span class="py-string">'mykey.pem'</span>,<span class="py-string">'r'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>key = RSA.importKey(f.read())</pre>
</blockquote>
<p>Even though you may choose to  directly use the methods of an RSA key object
to perform the primitive cryptographic operations (e.g. <a href="Crypto.PublicKey.RSA.RsaKey-class.html#_encrypt" class="link" onclick="show_private();">RsaKey._encrypt</a>),
it is recommended to use one of the standardized schemes instead (like
<a href="Crypto.Cipher.PKCS1_v1_5-module.html" class="link">Crypto.Cipher.PKCS1_v1_5</a> or <a href="Crypto.Signature.PKCS1_v1_5-module.html" class="link">Crypto.Signature.PKCS1_v1_5</a>).</p>

<!-- ==================== CLASSES ==================== -->
<a name="section-Classes"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Classes</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="Crypto.PublicKey.RSA.RsaKey-class.html" class="summary-name">RsaKey</a><br />
      Class defining an actual RSA key.
    </td>
  </tr>
</table>
<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Functions</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.PublicKey.RSA-module.html#generate" class="summary-sig-name">generate</a>(<span class="summary-sig-arg">bits</span>,
        <span class="summary-sig-arg">randfunc</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">e</span>=<span class="summary-sig-default">65537</span>)</span><br />
      Create a new RSA key.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.PublicKey.RSA-module.html#construct" class="summary-sig-name">construct</a>(<span class="summary-sig-arg">tup</span>,
        <span class="summary-sig-arg">consistency_check</span>=<span class="summary-sig-default">True</span>)</span><br />
      Construct an RSA key from a tuple of valid RSA components.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.PublicKey.RSA-module.html#importKey" class="summary-sig-name">importKey</a>(<span class="summary-sig-arg">extern_key</span>,
        <span class="summary-sig-arg">passphrase</span>=<span class="summary-sig-default">None</span>,
        <span class="summary-sig-arg">verify_x509_cert</span>=<span class="summary-sig-default">True</span>)</span><br />
      Import an RSA key (public or private half), encoded in standard
form.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Variables</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="oid"></a><span class="summary-name">oid</span> = <code title="'1.2.840.113549.1.1.1'"><code class="variable-quote">'</code><code class="variable-string">1.2.840.113549.1.1.1</code><code class="variable-quote">'</code></code><br />
      <a class="rst-reference external" href="http://www.alvestrand.no/objectid/1.2.840.113549.1.1.1.html" target="_top">Object ID</a> for the RSA encryption algorithm. This OID often indicates
a generic RSA key, even when such key will be actually used for digital
signatures.
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a href="Crypto.PublicKey.RSA-module.html#algorithmIdentifier" class="summary-name">algorithmIdentifier</a> = <code title="'0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00'"><code class="variable-quote">'</code><code class="variable-string">0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x</code><code class="variable-ellipsis">...</code></code><br />
      This is the standard DER object that qualifies a cryptographic algorithm
in ASN.1-based data structures (e.g. X.509 certificates).
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Function Details</span></td>
</tr>
</table>
<a name="generate"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">generate</span>(<span class="sig-arg">bits</span>,
        <span class="sig-arg">randfunc</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">e</span>=<span class="sig-default">65537</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Create a new RSA key.</p>
<p>The algorithm closely follows NIST <a class="rst-reference external" href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf" target="_top">FIPS 186-4</a> in its
sections B.3.1 and B.3.3. The modulus is the product of
two non-strong probable primes.
Each prime passes a suitable number of Miller-Rabin tests
with random bases and a single Lucas test.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>bits</code></strong> (integer) - Key length, or size (in bits) of the RSA modulus.
It must be at least 1024.
The FIPS standard only defines 1024, 2048 and 3072.</li>
        <li><strong class="pname"><code>randfunc</code></strong> (callable) - Function that returns random bytes.
The default is <a href="Crypto.Random-module.html#get_random_bytes" class="link" onclick="show_private();">Crypto.Random.get_random_bytes</a>.</li>
        <li><strong class="pname"><code>e</code></strong> (integer) - Public RSA exponent. It must be an odd positive integer.
It is typically a small number with very few ones in its
binary representation.
The FIPS standard requires the public exponent to be
at least 65537 (the default).</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>An RSA key object (<a href="Crypto.PublicKey.RSA.RsaKey-class.html" class="link">RsaKey</a>).</dd>
  </dl>
</td></tr></table>
</div>
<a name="construct"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">construct</span>(<span class="sig-arg">tup</span>,
        <span class="sig-arg">consistency_check</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Construct an RSA key from a tuple of valid RSA components.</p>
<p>The modulus <strong>n</strong> must be the product of two primes.
The public exponent <strong>e</strong> must be odd and larger than 1.</p>
<p>In case of a private key, the following equations must apply:</p>
<ul class="rst-simple">
<li>e != 1</li>
<li>p*q = n</li>
<li>e*d = 1 mod lcm[(p-1)(q-1)]</li>
<li>p*u = 1 mod q</li>
</ul>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><p><strong class="pname"><code>tup</code></strong> (tuple) - A tuple of long integers, with at least 2 and no
more than 6 items. The items come in the following order:</p>
<blockquote>
<ol class="rst-arabic simple">
<li>RSA modulus (<em>n</em>).</li>
<li>Public exponent (<em>e</em>).</li>
<li>Private exponent (<em>d</em>).
Only required if the key is private.</li>
<li>First factor of <em>n</em> (<em>p</em>).
Optional, but factor q must also be present.</li>
<li>Second factor of <em>n</em> (<em>q</em>). Optional.</li>
<li>CRT coefficient, <em>(1/p) mod q</em> (<em>u</em>). Optional.</li>
</ol>
</blockquote></li>
        <li><strong class="pname"><code>consistency_check</code></strong> (boolean) - If <em>True</em>, the library will verify that the provided components
fulfil the main RSA properties.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>An RSA key object (<a href="Crypto.PublicKey.RSA.RsaKey-class.html" class="link">RsaKey</a>).</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>ValueError</strong></code> - When the key being imported fails the most basic RSA validity checks.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="importKey"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">importKey</span>(<span class="sig-arg">extern_key</span>,
        <span class="sig-arg">passphrase</span>=<span class="sig-default">None</span>,
        <span class="sig-arg">verify_x509_cert</span>=<span class="sig-default">True</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Import an RSA key (public or private half), encoded in standard
form.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><p><strong class="pname"><code>extern_key</code></strong> (string) - The RSA key to import, encoded as a byte string.</p>
<p>An RSA public key can be in any of the following formats:</p>
<ul class="rst-simple">
<li>X.509 certificate (binary or PEM format)</li>
<li>X.509 <tt class="rst-docutils literal">subjectPublicKeyInfo</tt> DER SEQUENCE (binary or PEM
encoding)</li>
<li><a class="rst-reference external" href="http://www.ietf.org/rfc/rfc3447.txt" target="_top">PKCS#1</a> <tt class="rst-docutils literal">RSAPublicKey</tt> DER SEQUENCE (binary or PEM encoding)</li>
<li>OpenSSH (textual public key only)</li>
</ul>
<p>An RSA private key can be in any of the following formats:</p>
<ul class="rst-simple">
<li>PKCS#1 <tt class="rst-docutils literal">RSAPrivateKey</tt> DER SEQUENCE (binary or PEM encoding)</li>
<li><a class="rst-reference external" href="http://www.ietf.org/rfc/rfc5208.txt" target="_top">PKCS#8</a> <tt class="rst-docutils literal">PrivateKeyInfo</tt> or <tt class="rst-docutils literal">EncryptedPrivateKeyInfo</tt>
DER SEQUENCE (binary or PEM encoding)</li>
<li>OpenSSH (textual public key only)</li>
</ul>
<p>For details about the PEM encoding, see <a class="rst-reference external" href="http://www.ietf.org/rfc/rfc1421.txt" target="_top">RFC1421</a>/<a class="rst-reference external" href="http://www.ietf.org/rfc/rfc1423.txt" target="_top">RFC1423</a>.</p>
<p>The private key may be encrypted by means of a certain pass phrase
either at the PEM level or at the PKCS#8 level.</p></li>
        <li><strong class="pname"><code>passphrase</code></strong> (string) - In case of an encrypted private key, this is the pass phrase from
which the decryption key is derived.</li>
        <li><p><strong class="pname"><code>verify_x509_cert</code></strong> (bool) - When importing the public key from an X.509 certificate, whether
the certificate should be validated. <strong>Since verification is not
yet supported, this value must always be set to False</strong>.</p>
<p>This value is ignored if an X.509 certificate is not passed.</p></li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>An RSA key object (<a href="Crypto.PublicKey.RSA.RsaKey-class.html" class="link">RsaKey</a>).</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>ValueError/IndexError/TypeError</strong></code> - When the given key cannot be parsed (possibly because the pass
phrase is wrong).</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== VARIABLES DETAILS ==================== -->
<a name="section-VariablesDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Variables Details</span></td>
</tr>
</table>
<a name="algorithmIdentifier"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <h3 class="epydoc">algorithmIdentifier</h3>
  This is the standard DER object that qualifies a cryptographic algorithm
in ASN.1-based data structures (e.g. X.509 certificates).
  <dl class="fields">
  </dl>
  <dl class="fields">
    <dt>Value:</dt>
      <dd><table><tr><td><pre class="variable">
<code class="variable-quote">'</code><code class="variable-string">0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00</code><code class="variable-quote">'</code>
</pre></td></tr></table>
</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="Crypto-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.pycryptodome.org/">PyCryptodome.org</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Mar 16 21:14:19 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
