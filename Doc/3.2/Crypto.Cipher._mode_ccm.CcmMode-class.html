<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Crypto.Cipher._mode_ccm.CcmMode</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="Crypto-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.pycryptodome.org/">PyCryptodome.org</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="Crypto-module.html">Package&nbsp;Crypto</a> ::
        <a href="Crypto.Cipher-module.html">Package&nbsp;Cipher</a> ::
        <a href="Crypto.Cipher._mode_ccm-module.html" onclick="show_private();">Module&nbsp;_mode_ccm</a> ::
        Class&nbsp;CcmMode
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class CcmMode</h1><p class="nomargin-top"></p>
<pre class="base-tree">
object --+
         |
        <strong class="uidshort">CcmMode</strong>
</pre>

<hr />
<p>Counter with CBC-MAC (CCM).</p>
<p>This is an Authenticated Encryption with Associated Data (<a class="rst-reference external" href="http://blog.cryptographyengineering.com/2012/05/how-to-choose-authenticated-encryption.html" target="_top">AEAD</a>) mode.
It provides both confidentiality and authenticity.</p>
<p>The header of the message may be left in the clear, if needed, and it will
still be subject to authentication. The decryption step tells the receiver
if the message comes from a source that really knowns the secret key.
Additionally, decryption detects if any part of the message - including the
header - has been modified or corrupted.</p>
<p>This mode requires a nonce. The nonce shall never repeat for two
different messages encrypted with the same key, but it does not need
to be random.
Note that there is a trade-off between the size of the nonce and the
maximum size of a single message you can encrypt.</p>
<p>It is important to use a large nonce if the key is reused across several
messages and the nonce is chosen randomly.</p>
<p>It is acceptable to us a short nonce if the key is only used a few times or
if the nonce is taken from a counter.</p>
<p>The following table shows the trade-off when the nonce is chosen at
random. The column on the left shows how many messages it takes
for the keystream to repeat <strong>on average</strong>. In practice, you will want to
stop using the key way before that.</p>
<table border="1" class="rst-docutils">
<colgroup>
<col width="37%" />
<col width="28%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr><th class="rst-head">Avg. # of messages
before keystream
repeats</th>
<th class="rst-head">nonce
size
(bytes)</th>
<th class="rst-head">Max. message
size
(bytes)</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>2^52</td>
<td>13</td>
<td>64K</td>
</tr>
<tr><td>2^48</td>
<td>12</td>
<td>16M</td>
</tr>
<tr><td>2^44</td>
<td>11</td>
<td>4G</td>
</tr>
<tr><td>2^40</td>
<td>10</td>
<td>1T</td>
</tr>
<tr><td>2^36</td>
<td>9</td>
<td>64P</td>
</tr>
<tr><td>2^32</td>
<td>8</td>
<td>16E</td>
</tr>
</tbody>
</table>
<p>This mode is only available for ciphers that operate on 128 bits blocks
(e.g. AES but not TDES).</p>
<p>See <a class="rst-reference external" href="http://csrc.nist.gov/publications/nistpubs/800-38C/SP800-38C.pdf" target="_top">NIST SP800-38C</a> or <a class="rst-reference external" href="https://tools.ietf.org/html/rfc3610" target="_top">RFC3610</a>.</p>

<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Instance Methods</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">factory</span>,
        <span class="summary-sig-arg">**kwargs</span>)</span><br />
      Create a new block cipher, configured in CCM mode.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#update" class="summary-sig-name">update</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">assoc_data</span>)</span><br />
      Protect associated data</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#encrypt" class="summary-sig-name">encrypt</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">plaintext</span>)</span><br />
      Encrypt data with the key set at initialization.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#decrypt" class="summary-sig-name">decrypt</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">ciphertext</span>)</span><br />
      Decrypt data with the key set at initialization.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#digest" class="summary-sig-name">digest</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Compute the <em>binary</em> MAC tag.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#hexdigest" class="summary-sig-name">hexdigest</a>(<span class="summary-sig-arg">self</span>)</span><br />
      Compute the <em>printable</em> MAC tag.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#verify" class="summary-sig-name">verify</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">received_mac_tag</span>)</span><br />
      Validate the <em>binary</em> MAC tag.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#hexverify" class="summary-sig-name">hexverify</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">hex_mac_tag</span>)</span><br />
      Validate the <em>printable</em> MAC tag.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#encrypt_and_digest" class="summary-sig-name">encrypt_and_digest</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">plaintext</span>)</span><br />
      Perform encrypt() and digest() in one step.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#decrypt_and_verify" class="summary-sig-name">decrypt_and_verify</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">ciphertext</span>,
        <span class="summary-sig-arg">received_mac_tag</span>)</span><br />
      Perform decrypt() and verify() in one step.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__delattr__</code>,
      <code>__format__</code>,
      <code>__getattribute__</code>,
      <code>__hash__</code>,
      <code>__new__</code>,
      <code>__reduce__</code>,
      <code>__reduce_ex__</code>,
      <code>__repr__</code>,
      <code>__setattr__</code>,
      <code>__sizeof__</code>,
      <code>__str__</code>,
      <code>__subclasshook__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Properties</span></td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__class__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Method Details</span></td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">factory</span>,
        <span class="sig-arg">**kwargs</span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  Create a new block cipher, configured in CCM mode.
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>factory</code></strong> (module) - A symmetric cipher module from <a href="Crypto.Cipher-module.html" class="link">Crypto.Cipher</a>
(like <a href="Crypto.Cipher.AES-module.html" class="link">Crypto.Cipher.AES</a>).</li>
        <li><strong class="pname"><code>key</code></strong> (byte string) - The secret key to use in the symmetric cipher.</li>
        <li><p><strong class="pname"><code>nonce</code></strong> (byte string) - A mandatory value that must never be reused for any other encryption.</p>
<p>Its length must be in the range <tt class="rst-docutils literal"><span class="pre">[7..13]</span></tt>.
11 or 12 bytes are reasonable values in general. Bear in
mind that with CCM there is a trade-off between nonce length and
maximum message size.</p></li>
        <li><strong class="pname"><code>mac_len</code></strong> (integer) - Length of the MAC, in bytes. It must be even and in
the range <tt class="rst-docutils literal"><span class="pre">[4..16]</span></tt>. The default is 16.</li>
        <li><strong class="pname"><code>msg_len</code></strong> (integer) - Length of the message to (de)cipher.
If not specified, <tt class="rst-docutils literal">encrypt</tt> or <tt class="rst-docutils literal">decrypt</tt> may only be called once.</li>
        <li><strong class="pname"><code>assoc_len</code></strong> (integer) - Length of the associated data.
If not specified, all data is internally buffered.</li>
    </ul></dd>
    <dt>Overrides:
        object.__init__
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="update"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">update</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">assoc_data</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Protect associated data</p>
<p>If there is any associated data, the caller has to invoke
this function one or more times, before using
<tt class="rst-docutils literal">decrypt</tt> or <tt class="rst-docutils literal">encrypt</tt>.</p>
<p>By <em>associated data</em> it is meant any data (e.g. packet headers) that
will not be encrypted and will be transmitted in the clear.
However, the receiver is still able to detect any modification to it.
In CCM, the <em>associated data</em> is also called
<em>additional authenticated data</em> (AAD).</p>
<p>If there is no associated data, this method must not be called.</p>
<p>The caller may split associated data in segments of any size, and
invoke this method multiple times, each time with the next segment.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>assoc_data</code></strong> (byte string) - A piece of associated data. There are no restrictions on its size.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="encrypt"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">encrypt</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">plaintext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Encrypt data with the key set at initialization.</p>
<p>A cipher object is stateful: once you have encrypted a message
you cannot encrypt (or decrypt) another message using the same
object.</p>
<p>This method can be called only <strong>once</strong> if <tt class="rst-docutils literal">msg_len</tt> was
not passed at initialization.</p>
<p>If <tt class="rst-docutils literal">msg_len</tt> was given, the data to encrypt can be broken
up in two or more pieces and <a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#encrypt" class="link">encrypt</a> can be called
multiple times.</p>
<p>That is, the statement:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>c.encrypt(a) + c.encrypt(b)</pre>
</blockquote>
<p>is equivalent to:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>c.encrypt(a+b)</pre>
</blockquote>
<p>This function does not add any padding to the plaintext.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>plaintext</code></strong> (byte string) - The piece of data to encrypt.
It can be of any length.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>the encrypted data, as a byte string.
It is as long as <em>plaintext</em>.</dd>
  </dl>
</td></tr></table>
</div>
<a name="decrypt"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">decrypt</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">ciphertext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Decrypt data with the key set at initialization.</p>
<p>A cipher object is stateful: once you have decrypted a message
you cannot decrypt (or encrypt) another message with the same
object.</p>
<p>This method can be called only <strong>once</strong> if <tt class="rst-docutils literal">msg_len</tt> was
not passed at initialization.</p>
<p>If <tt class="rst-docutils literal">msg_len</tt> was given, the data to decrypt can be
broken up in two or more pieces and <a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#decrypt" class="link">decrypt</a> can be
called multiple times.</p>
<p>That is, the statement:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>c.decrypt(a) + c.decrypt(b)</pre>
</blockquote>
<p>is equivalent to:</p>
<blockquote>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>c.decrypt(a+b)</pre>
</blockquote>
<p>This function does not remove any padding from the plaintext.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ciphertext</code></strong> (byte string) - The piece of data to decrypt.
It can be of any length.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>the decrypted data (byte string).</dd>
  </dl>
</td></tr></table>
</div>
<a name="digest"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">digest</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the <em>binary</em> MAC tag.</p>
<p>The caller invokes this function at the very end.</p>
<p>This method returns the MAC that shall be sent to the receiver,
together with the ciphertext.</p>
  <dl class="fields">
    <dt>Returns:</dt>
        <dd>the MAC, as a byte string.</dd>
  </dl>
</td></tr></table>
</div>
<a name="hexdigest"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">hexdigest</span>(<span class="sig-arg">self</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Compute the <em>printable</em> MAC tag.</p>
<p>This method is like <a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#digest" class="link">digest</a>.</p>
  <dl class="fields">
    <dt>Returns:</dt>
        <dd>the MAC, as a hexadecimal string.</dd>
  </dl>
</td></tr></table>
</div>
<a name="verify"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">verify</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">received_mac_tag</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Validate the <em>binary</em> MAC tag.</p>
<p>The caller invokes this function at the very end.</p>
<p>This method checks if the decrypted message is indeed valid
(that is, if the key is correct) and it has not been
tampered with while in transit.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>received_mac_tag</code></strong> (byte string) - This is the <em>binary</em> MAC, as received from the sender.</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>ValueError</strong></code> - if the MAC does not match. The message has been tampered with
or the key is incorrect.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="hexverify"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">hexverify</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">hex_mac_tag</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Validate the <em>printable</em> MAC tag.</p>
<p>This method is like <a href="Crypto.Cipher._mode_ccm.CcmMode-class.html#verify" class="link">verify</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>hex_mac_tag</code></strong> (string) - This is the <em>printable</em> MAC, as received from the sender.</li>
    </ul></dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>ValueError</strong></code> - if the MAC does not match. The message has been tampered with
or the key is incorrect.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="encrypt_and_digest"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">encrypt_and_digest</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">plaintext</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  Perform encrypt() and digest() in one step.
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>plaintext</code></strong> (byte string) - The piece of data to encrypt.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd><p>a tuple with two byte strings:</p>
<ul class="rst-simple">
<li>the encrypted data</li>
<li>the MAC</li>
</ul></dd>
  </dl>
</td></tr></table>
</div>
<a name="decrypt_and_verify"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">decrypt_and_verify</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">ciphertext</span>,
        <span class="sig-arg">received_mac_tag</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  Perform decrypt() and verify() in one step.
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>ciphertext</code></strong> (byte string) - The piece of data to decrypt.</li>
        <li><strong class="pname"><code>received_mac_tag</code></strong> (byte string) - This is the <em>binary</em> MAC, as received from the sender.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>the decrypted data (byte string).</dd>
    <dt>Raises:</dt>
    <dd><ul class="nomargin-top">
        <li><code><strong class='fraise'>ValueError</strong></code> - if the MAC does not match. The message has been tampered with
or the key is incorrect.</li>
    </ul></dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="Crypto-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.pycryptodome.org/">PyCryptodome.org</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat Sep  5 22:08:39 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
