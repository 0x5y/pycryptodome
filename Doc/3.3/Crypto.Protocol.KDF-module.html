<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Crypto.Protocol.KDF</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="Crypto-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.pycryptodome.org/">PyCryptodome.org</a></th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="Crypto-module.html">Package&nbsp;Crypto</a> ::
        <a href="Crypto.Protocol-module.html">Package&nbsp;Protocol</a> ::
        Module&nbsp;KDF
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module KDF</h1><p class="nomargin-top"></p>
<p>This file contains a collection of standard key derivation functions.</p>
<p>A key derivation function derives one or more secondary secret keys from
one primary secret (a master key or a pass phrase).</p>
<p>This is typically done to insulate the secondary keys from each other,
to avoid that leakage of a secondary key compromises the security of the
master key, or to thwart attacks on pass phrases (e.g. via rainbow tables).</p>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Functions</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Protocol.KDF-module.html#PBKDF1" class="summary-sig-name">PBKDF1</a>(<span class="summary-sig-arg">password</span>,
        <span class="summary-sig-arg">salt</span>,
        <span class="summary-sig-arg">dkLen</span>,
        <span class="summary-sig-arg">count</span>=<span class="summary-sig-default">1000</span>,
        <span class="summary-sig-arg">hashAlgo</span>=<span class="summary-sig-default">None</span>)</span><br />
      Derive one key from a password (or passphrase).</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Protocol.KDF-module.html#PBKDF2" class="summary-sig-name">PBKDF2</a>(<span class="summary-sig-arg">password</span>,
        <span class="summary-sig-arg">salt</span>,
        <span class="summary-sig-arg">dkLen</span>=<span class="summary-sig-default">16</span>,
        <span class="summary-sig-arg">count</span>=<span class="summary-sig-default">1000</span>,
        <span class="summary-sig-arg">prf</span>=<span class="summary-sig-default">None</span>)</span><br />
      Derive one or more keys from a password (or passphrase).</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Protocol.KDF-module.html#HKDF" class="summary-sig-name">HKDF</a>(<span class="summary-sig-arg">master</span>,
        <span class="summary-sig-arg">key_len</span>,
        <span class="summary-sig-arg">salt</span>,
        <span class="summary-sig-arg">hashmod</span>,
        <span class="summary-sig-arg">num_keys</span>=<span class="summary-sig-default">1</span>,
        <span class="summary-sig-arg">context</span>=<span class="summary-sig-default">None</span>)</span><br />
      Derive one or more keys from a master secret using
the HMAC-based KDF defined in <a class="rst-reference external" href="http://tools.ietf.org/html/rfc5869" target="_top">RFC5869</a>.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="Crypto.Protocol.KDF-module.html#scrypt" class="summary-sig-name">scrypt</a>(<span class="summary-sig-arg">password</span>,
        <span class="summary-sig-arg">salt</span>,
        <span class="summary-sig-arg">key_len</span>,
        <span class="summary-sig-arg">N</span>,
        <span class="summary-sig-arg">r</span>,
        <span class="summary-sig-arg">p</span>,
        <span class="summary-sig-arg">num_keys</span>=<span class="summary-sig-default">1</span>)</span><br />
      Derive one or more keys from a passphrase.</td>
          <td align="right" valign="top">
            
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Variables</span></td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'Crypto.Protocol'"><code class="variable-quote">'</code><code class="variable-string">Crypto.Protocol</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td align="left" colspan="2" class="table-header">
    <span class="table-header">Function Details</span></td>
</tr>
</table>
<a name="PBKDF1"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">PBKDF1</span>(<span class="sig-arg">password</span>,
        <span class="sig-arg">salt</span>,
        <span class="sig-arg">dkLen</span>,
        <span class="sig-arg">count</span>=<span class="sig-default">1000</span>,
        <span class="sig-arg">hashAlgo</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Derive one key from a password (or passphrase).</p>
<p>This function performs key derivation according an old version of
the PKCS#5 standard (v1.5).</p>
<p>This algorithm is called <tt class="rst-docutils literal">PBKDF1</tt>. Even though it is still described
in the latest version of the PKCS#5 standard (version 2, or RFC2898),
newer applications should use the more secure and versatile <a href="Crypto.Protocol.KDF-module.html#PBKDF2" class="link">PBKDF2</a> instead.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>password</code></strong> (string) - The secret password or pass phrase to generate the key from.</li>
        <li><strong class="pname"><code>salt</code></strong> (byte string) - An 8 byte string to use for better protection from dictionary attacks.
This value does not need to be kept secret, but it should be randomly
chosen for each derivation.</li>
        <li><strong class="pname"><code>dkLen</code></strong> (integer) - The length of the desired key. Default is 16 bytes, suitable for instance for <a href="Crypto.Cipher.AES-module.html" class="link">Crypto.Cipher.AES</a>.</li>
        <li><strong class="pname"><code>count</code></strong> (integer) - The number of iterations to carry out. It's recommended to use at least 1000.</li>
        <li><strong class="pname"><code>hashAlgo</code></strong> (module) - The hash algorithm to use, as a module or an object from the <a href="Crypto.Hash-module.html" class="link">Crypto.Hash</a> package.
The digest length must be no shorter than <tt class="rst-docutils literal">dkLen</tt>.
The default algorithm is <a href="Crypto.Hash.SHA1-module.html" class="link">SHA1</a>.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>A byte string of length <code class="link">dkLen</code> that can be used as key.</dd>
  </dl>
</td></tr></table>
</div>
<a name="PBKDF2"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">PBKDF2</span>(<span class="sig-arg">password</span>,
        <span class="sig-arg">salt</span>,
        <span class="sig-arg">dkLen</span>=<span class="sig-default">16</span>,
        <span class="sig-arg">count</span>=<span class="sig-default">1000</span>,
        <span class="sig-arg">prf</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Derive one or more keys from a password (or passphrase).</p>
<p>This function performs key derivation according to
the PKCS#5 standard (v2.0), by means of the <tt class="rst-docutils literal">PBKDF2</tt> algorithm.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>password</code></strong> (string) - The secret password or pass phrase to generate the key from.</li>
        <li><strong class="pname"><code>salt</code></strong> (string) - A string to use for better protection from dictionary attacks.
This value does not need to be kept secret, but it should be randomly
chosen for each derivation. It is recommended to be at least 8 bytes long.</li>
        <li><strong class="pname"><code>dkLen</code></strong> (integer) - The cumulative length of the desired keys. Default is 16 bytes, suitable for instance for <a href="Crypto.Cipher.AES-module.html" class="link">Crypto.Cipher.AES</a>.</li>
        <li><strong class="pname"><code>count</code></strong> (integer) - The number of iterations to carry out. It's recommended to use at least 1000.</li>
        <li><strong class="pname"><code>prf</code></strong> (callable) - A pseudorandom function. It must be a function that returns a pseudorandom string
from two parameters: a secret and a salt. If not specified, HMAC-SHA1 is used.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>A byte string of length <code class="link">dkLen</code> that can be used as key material.
If you wanted multiple keys, just break up this string into segments of the desired length.</dd>
  </dl>
</td></tr></table>
</div>
<a name="HKDF"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">HKDF</span>(<span class="sig-arg">master</span>,
        <span class="sig-arg">key_len</span>,
        <span class="sig-arg">salt</span>,
        <span class="sig-arg">hashmod</span>,
        <span class="sig-arg">num_keys</span>=<span class="sig-default">1</span>,
        <span class="sig-arg">context</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Derive one or more keys from a master secret using
the HMAC-based KDF defined in <a class="rst-reference external" href="http://tools.ietf.org/html/rfc5869" target="_top">RFC5869</a>.</p>
<p>This KDF is not suitable for deriving keys from a password or for key
stretching. Use <a href="Crypto.Protocol.KDF-module.html#PBKDF2" class="link">PBKDF2</a> instead.</p>
<p>HKDF is a key derivation method approved by NIST in <a class="rst-reference external" href="http://csrc.nist.gov/publications/nistpubs/800-56C/SP-800-56C.pdf" target="_top">SP 800 56C</a>.</p>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>master</code></strong> (byte string) - The unguessable value used by the KDF to generate the other keys.
It must be a high-entropy secret, though not necessarily uniform.
It must not be a password.</li>
        <li><strong class="pname"><code>salt</code></strong> (byte string) - A non-secret, reusable value that strengthens the randomness
extraction step.
Ideally, it is as long as the digest size of the chosen hash.
If empty, a string of zeroes in used.</li>
        <li><strong class="pname"><code>key_len</code></strong> (integer) - The length in bytes of every derived key.</li>
        <li><strong class="pname"><code>hashmod</code></strong> (module) - A cryptographic hash algorithm from <a href="Crypto.Hash-module.html" class="link">Crypto.Hash</a>.
<a href="Crypto.Hash.SHA512-module.html" class="link">Crypto.Hash.SHA512</a> is a good choice.</li>
        <li><strong class="pname"><code>num_keys</code></strong> (integer) - The number of keys to derive. Every key is <tt class="rst-docutils literal">key_len</tt> bytes long.
The maximum cumulative length of all keys is
255 times the digest size.</li>
        <li><strong class="pname"><code>context</code></strong> (byte string) - Optional identifier describing what the keys are used for.</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>A byte string or a tuple of byte strings.</dd>
  </dl>
</td></tr></table>
</div>
<a name="scrypt"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">scrypt</span>(<span class="sig-arg">password</span>,
        <span class="sig-arg">salt</span>,
        <span class="sig-arg">key_len</span>,
        <span class="sig-arg">N</span>,
        <span class="sig-arg">r</span>,
        <span class="sig-arg">p</span>,
        <span class="sig-arg">num_keys</span>=<span class="sig-default">1</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    >&nbsp;
    </td>
  </tr></table>
  
  <p>Derive one or more keys from a passphrase.</p>
<p>This function performs key derivation according to
the <a class="rst-reference external" href="http://www.tarsnap.com/scrypt.html" target="_top">scrypt</a> algorithm, introduced in Percival's paper
<a class="rst-reference external" href="http://www.tarsnap.com/scrypt/scrypt.pdf" target="_top">&quot;Stronger key derivation via sequential memory-hard functions&quot;</a>.</p>
<p>This implementation is based on the <a class="rst-reference external" href="http://tools.ietf.org/html/draft-josefsson-scrypt-kdf-03" target="_top">RFC draft</a>.</p>
<p>A good choice of parameters <em>(N, r , p)</em> was suggested
by Colin Percival in his <a class="rst-reference external" href="http://www.tarsnap.com/scrypt/scrypt-slides.pdf" target="_top">presentation in 2009</a>:</p>
<ul class="rst-simple">
<li><em>(16384, 8, 1)</em> for interactive logins (&lt;=100ms)</li>
<li><em>(1048576, 8, 1)</em> for file encryption (&lt;=5s)</li>
</ul>
  <dl class="fields">
    <dt>Parameters:</dt>
    <dd><ul class="nomargin-top">
        <li><strong class="pname"><code>password</code></strong> (string) - The secret pass phrase to generate the keys from.</li>
        <li><strong class="pname"><code>salt</code></strong> (string) - A string to use for better protection from dictionary attacks.
This value does not need to be kept secret,
but it should be randomly chosen for each derivation.
It is recommended to be at least 8 bytes long.</li>
        <li><strong class="pname"><code>key_len</code></strong> (integer) - The length in bytes of every derived key.</li>
        <li><strong class="pname"><code>N</code></strong> (integer) - CPU/Memory cost parameter. It must be a power of 2 and less
than <tt class="rst-docutils literal"><span class="pre">2**32</span></tt>.</li>
        <li><strong class="pname"><code>r</code></strong> (integer) - Block size parameter.</li>
        <li><strong class="pname"><code>p</code></strong> (integer) - Parallelization parameter.
It must be no greater than <tt class="rst-docutils literal"><span class="pre">(2**32-1)/(4r)</span></tt>.</li>
        <li><strong class="pname"><code>num_keys</code></strong> (integer) - The number of keys to derive. Every key is <tt class="rst-docutils literal">key_len</tt> bytes long.
By default, only 1 key is generated.
The maximum cumulative length of all keys is <tt class="rst-docutils literal"><span class="pre">(2**32-1)*32</span></tt>
(that is, 128TB).</li>
    </ul></dd>
    <dt>Returns:</dt>
        <dd>A byte string or a tuple of byte strings.</dd>
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="Crypto-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            ><a href="http://www.pycryptodome.org/">PyCryptodome.org</a></th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Wed Oct 28 22:24:02 2015
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
